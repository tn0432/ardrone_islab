<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="43,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S2T14U3">dcm</span> = quat2dcmsym( <span class="var type1" id="S3T2U6">q</span> )<span class="comment">%#codegen</span></span></span>
<span class="srcline"><span class="lineno"><a href="43,2" id="srcline2"> 2</a></span><span class="line"><span class="comment">%  QUAT2DCM Convert quaternion to direction cosine matrix.</span></span></span>
<span class="srcline"><span class="lineno"><a href="43,3" id="srcline3"> 3</a></span><span class="line"><span class="comment">%   N = QUAT2DCM( Q ) calculates the direction cosine matrix, N, for a</span></span></span>
<span class="srcline"><span class="lineno"><a href="43,4" id="srcline4"> 4</a></span><span class="line"><span class="comment">%   given quaternion, Q.  Input Q is an M-by-4 matrix containing M</span></span></span>
<span class="srcline"><span class="lineno"><a href="43,5" id="srcline5"> 5</a></span><span class="line"><span class="comment">%   quaternions.  N returns a 3-by-3-by-M matrix of direction cosine </span></span></span>
<span class="srcline"><span class="lineno"><a href="43,6" id="srcline6"> 6</a></span><span class="line"><span class="comment">%   matrices.  The direction cosine matrix performs the coordinate</span></span></span>
<span class="srcline"><span class="lineno"><a href="43,7" id="srcline7"> 7</a></span><span class="line"><span class="comment">%   transformation of a vector in inertial axes to a vector in body axes.</span></span></span>
<span class="srcline"><span class="lineno"><a href="43,8" id="srcline8"> 8</a></span><span class="line"><span class="comment">%   Each element of Q must be a real number.  Additionally, Q has its</span></span></span>
<span class="srcline"><span class="lineno"><a href="43,9" id="srcline9"> 9</a></span><span class="line"><span class="comment">%   scalar number as the first column. </span></span></span>
<span class="srcline"><span class="lineno"><a href="43,10" id="srcline10">10</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="43,11" id="srcline11">11</a></span><span class="line"><span class="comment">%   Examples:</span></span></span>
<span class="srcline"><span class="lineno"><a href="43,12" id="srcline12">12</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="43,13" id="srcline13">13</a></span><span class="line"><span class="comment">%   Determine the direction cosine matrix from q = [1 0 1 0]:</span></span></span>
<span class="srcline"><span class="lineno"><a href="43,14" id="srcline14">14</a></span><span class="line"><span class="comment">%      dcm = quat2dcm([1 0 1 0])</span></span></span>
<span class="srcline"><span class="lineno"><a href="43,15" id="srcline15">15</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="43,16" id="srcline16">16</a></span><span class="line"><span class="comment">%   Determine the direction cosine matrices from multiple quaternions:</span></span></span>
<span class="srcline"><span class="lineno"><a href="43,17" id="srcline17">17</a></span><span class="line"><span class="comment">%      q = [1 0 1 0; 1 0.5 0.3 0.1];</span></span></span>
<span class="srcline"><span class="lineno"><a href="43,18" id="srcline18">18</a></span><span class="line"><span class="comment">%      dcm = quat2dcm(q)</span></span></span>
<span class="srcline"><span class="lineno"><a href="43,19" id="srcline19">19</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="43,20" id="srcline20">20</a></span><span class="line"><span class="comment">%   See also ANGLE2DCM, DCM2ANGLE, DCM2QUAT, ANGLE2QUAT, QUAT2ANGLE, QUATROTATE. </span></span></span>
<span class="srcline"><span class="lineno"><a href="43,21" id="srcline21">21</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="43,22" id="srcline22">22</a></span><span class="line"><span class="comment">%   Copyright 2000-2007 The MathWorks, Inc.</span></span></span>
<span class="srcline"><span class="lineno"><a href="43,23" id="srcline23">23</a></span><span class="line"><span class="comment">%   $Revision: 1.1.6.3 $  $Date: 2007/05/10 13:42:37 $</span></span></span>
<span class="srcline"><span class="lineno"><a href="43,24" id="srcline24">24</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="43,25" id="srcline25">25</a></span><span class="line"><span class="comment">%qin = quatnormalize( q );</span></span></span>
<span class="srcline"><span class="lineno"><a href="43,26" id="srcline26">26</a></span><span class="line"><span class="mxinfo" id="T2:U3"><span class="var type1" id="S4T2U9">qin</span>=<span class="var type1" id="S3T2U10">q</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="43,27" id="srcline27">27</a></span><span class="line"><span class="comment">%syms xx real</span></span></span>
<span class="srcline"><span class="lineno"><a href="43,28" id="srcline28">28</a></span><span class="line"><span class="mxinfo" id="T14:U6"><span class="var type1" id="S2T14U13">dcm</span> = <span class="mxinfo" id="T14:U8">zeros(<span class="mxinfo" id="T4:U9">3</span>,<span class="mxinfo" id="T4:U10">3</span>,size(<span class="var type1" id="S4T2U20">qin</span>,1))</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="43,29" id="srcline29">29</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="43,30" id="srcline30">30</a></span><span class="line"><span class="mxinfo" id="T4:U12"><span class="mxinfo" id="T4:U13"><span class="var type1" id="S2T14U25">dcm</span>(<span class="mxinfo" id="T4:U15">1</span>,<span class="mxinfo" id="T4:U16">1</span>)</span> = <span class="mxinfo" id="T4:U17"><span class="mxinfo" id="T4:U18"><span class="mxinfo" id="T4:U19"><span class="mxinfo" id="T4:U20"><span class="mxinfo" id="T4:U21"><span class="var type1" id="S4T2U33">qin</span>(<span class="mxinfo" id="T4:U23">1</span>)</span>^2</span> + <span class="mxinfo" id="T4:U24"><span class="mxinfo" id="T4:U25"><span class="var type1" id="S4T2U38">qin</span>(<span class="mxinfo" id="T4:U27">2</span>)</span>^2</span></span> - <span class="mxinfo" id="T4:U28"><span class="mxinfo" id="T4:U29"><span class="var type1" id="S4T2U43">qin</span>(<span class="mxinfo" id="T4:U31">3</span>)</span>^2</span></span> - <span class="mxinfo" id="T4:U32"><span class="mxinfo" id="T4:U33"><span class="var type1" id="S4T2U48">qin</span>(<span class="mxinfo" id="T4:U35">4</span>)</span>^2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="43,31" id="srcline31">31</a></span><span class="line"><span class="mxinfo" id="T4:U36"><span class="mxinfo" id="T4:U37"><span class="var type1" id="S2T14U54">dcm</span>(<span class="mxinfo" id="T4:U39">1</span>,<span class="mxinfo" id="T4:U40">2</span>)</span> = <span class="mxinfo" id="T4:U41"><span class="mxinfo" id="T4:U42">2</span>.*(<span class="mxinfo" id="T4:U43"><span class="mxinfo" id="T4:U44"><span class="mxinfo" id="T4:U45"><span class="var type1" id="S4T2U63">qin</span>(<span class="mxinfo" id="T4:U47">2</span>)</span>.*<span class="mxinfo" id="T4:U48"><span class="var type1" id="S4T2U66">qin</span>(<span class="mxinfo" id="T4:U50">3</span>)</span></span> + <span class="mxinfo" id="T4:U51"><span class="mxinfo" id="T4:U52"><span class="var type1" id="S4T2U70">qin</span>(<span class="mxinfo" id="T4:U54">1</span>)</span>.*<span class="mxinfo" id="T4:U55"><span class="var type1" id="S4T2U73">qin</span>(<span class="mxinfo" id="T4:U57">4</span>)</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="43,32" id="srcline32">32</a></span><span class="line"><span class="mxinfo" id="T4:U58"><span class="mxinfo" id="T4:U59"><span class="var type1" id="S2T14U78">dcm</span>(<span class="mxinfo" id="T4:U61">1</span>,<span class="mxinfo" id="T4:U62">3</span>)</span> = <span class="mxinfo" id="T4:U63"><span class="mxinfo" id="T4:U64">2</span>.*(<span class="mxinfo" id="T4:U65"><span class="mxinfo" id="T4:U66"><span class="mxinfo" id="T4:U67"><span class="var type1" id="S4T2U87">qin</span>(<span class="mxinfo" id="T4:U69">2</span>)</span>.*<span class="mxinfo" id="T4:U70"><span class="var type1" id="S4T2U90">qin</span>(<span class="mxinfo" id="T4:U72">4</span>)</span></span> - <span class="mxinfo" id="T4:U73"><span class="mxinfo" id="T4:U74"><span class="var type1" id="S4T2U94">qin</span>(<span class="mxinfo" id="T4:U76">1</span>)</span>.*<span class="mxinfo" id="T4:U77"><span class="var type1" id="S4T2U97">qin</span>(<span class="mxinfo" id="T4:U79">3</span>)</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="43,33" id="srcline33">33</a></span><span class="line"><span class="mxinfo" id="T4:U80"><span class="mxinfo" id="T4:U81"><span class="var type1" id="S2T14U102">dcm</span>(<span class="mxinfo" id="T4:U83">2</span>,<span class="mxinfo" id="T4:U84">1</span>)</span> = <span class="mxinfo" id="T4:U85"><span class="mxinfo" id="T4:U86">2</span>.*(<span class="mxinfo" id="T4:U87"><span class="mxinfo" id="T4:U88"><span class="mxinfo" id="T4:U89"><span class="var type1" id="S4T2U111">qin</span>(<span class="mxinfo" id="T4:U91">2</span>)</span>.*<span class="mxinfo" id="T4:U92"><span class="var type1" id="S4T2U114">qin</span>(<span class="mxinfo" id="T4:U94">3</span>)</span></span> - <span class="mxinfo" id="T4:U95"><span class="mxinfo" id="T4:U96"><span class="var type1" id="S4T2U118">qin</span>(<span class="mxinfo" id="T4:U98">1</span>)</span>.*<span class="mxinfo" id="T4:U99"><span class="var type1" id="S4T2U121">qin</span>(<span class="mxinfo" id="T4:U101">4</span>)</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="43,34" id="srcline34">34</a></span><span class="line"><span class="mxinfo" id="T4:U102"><span class="mxinfo" id="T4:U103"><span class="var type1" id="S2T14U126">dcm</span>(<span class="mxinfo" id="T4:U105">2</span>,<span class="mxinfo" id="T4:U106">2</span>)</span> = <span class="mxinfo" id="T4:U107"><span class="mxinfo" id="T4:U108"><span class="mxinfo" id="T4:U109"><span class="mxinfo" id="T4:U110"><span class="mxinfo" id="T4:U111"><span class="var type1" id="S4T2U134">qin</span>(<span class="mxinfo" id="T4:U113">1</span>)</span>.^2</span> - <span class="mxinfo" id="T4:U114"><span class="mxinfo" id="T4:U115"><span class="var type1" id="S4T2U139">qin</span>(<span class="mxinfo" id="T4:U117">2</span>)</span>.^2</span></span> + <span class="mxinfo" id="T4:U118"><span class="mxinfo" id="T4:U119"><span class="var type1" id="S4T2U144">qin</span>(<span class="mxinfo" id="T4:U121">3</span>)</span>.^2</span></span> - <span class="mxinfo" id="T4:U122"><span class="mxinfo" id="T4:U123"><span class="var type1" id="S4T2U149">qin</span>(<span class="mxinfo" id="T4:U125">4</span>)</span>.^2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="43,35" id="srcline35">35</a></span><span class="line"><span class="mxinfo" id="T4:U126"><span class="mxinfo" id="T4:U127"><span class="var type1" id="S2T14U155">dcm</span>(<span class="mxinfo" id="T4:U129">2</span>,<span class="mxinfo" id="T4:U130">3</span>)</span> = <span class="mxinfo" id="T4:U131"><span class="mxinfo" id="T4:U132">2</span>.*(<span class="mxinfo" id="T4:U133"><span class="mxinfo" id="T4:U134"><span class="mxinfo" id="T4:U135"><span class="var type1" id="S4T2U164">qin</span>(<span class="mxinfo" id="T4:U137">3</span>)</span>.*<span class="mxinfo" id="T4:U138"><span class="var type1" id="S4T2U167">qin</span>(<span class="mxinfo" id="T4:U140">4</span>)</span></span> + <span class="mxinfo" id="T4:U141"><span class="mxinfo" id="T4:U142"><span class="var type1" id="S4T2U171">qin</span>(<span class="mxinfo" id="T4:U144">1</span>)</span>.*<span class="mxinfo" id="T4:U145"><span class="var type1" id="S4T2U174">qin</span>(<span class="mxinfo" id="T4:U147">2</span>)</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="43,36" id="srcline36">36</a></span><span class="line"><span class="mxinfo" id="T4:U148"><span class="mxinfo" id="T4:U149"><span class="var type1" id="S2T14U179">dcm</span>(<span class="mxinfo" id="T4:U151">3</span>,<span class="mxinfo" id="T4:U152">1</span>)</span> = <span class="mxinfo" id="T4:U153"><span class="mxinfo" id="T4:U154">2</span>.*(<span class="mxinfo" id="T4:U155"><span class="mxinfo" id="T4:U156"><span class="mxinfo" id="T4:U157"><span class="var type1" id="S4T2U188">qin</span>(<span class="mxinfo" id="T4:U159">2</span>)</span>.*<span class="mxinfo" id="T4:U160"><span class="var type1" id="S4T2U191">qin</span>(<span class="mxinfo" id="T4:U162">4</span>)</span></span> + <span class="mxinfo" id="T4:U163"><span class="mxinfo" id="T4:U164"><span class="var type1" id="S4T2U195">qin</span>(<span class="mxinfo" id="T4:U166">1</span>)</span>.*<span class="mxinfo" id="T4:U167"><span class="var type1" id="S4T2U198">qin</span>(<span class="mxinfo" id="T4:U169">3</span>)</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="43,37" id="srcline37">37</a></span><span class="line"><span class="mxinfo" id="T4:U170"><span class="mxinfo" id="T4:U171"><span class="var type1" id="S2T14U203">dcm</span>(<span class="mxinfo" id="T4:U173">3</span>,<span class="mxinfo" id="T4:U174">2</span>)</span> = <span class="mxinfo" id="T4:U175"><span class="mxinfo" id="T4:U176">2</span>.*(<span class="mxinfo" id="T4:U177"><span class="mxinfo" id="T4:U178"><span class="mxinfo" id="T4:U179"><span class="var type1" id="S4T2U212">qin</span>(<span class="mxinfo" id="T4:U181">3</span>)</span>.*<span class="mxinfo" id="T4:U182"><span class="var type1" id="S4T2U215">qin</span>(<span class="mxinfo" id="T4:U184">4</span>)</span></span> - <span class="mxinfo" id="T4:U185"><span class="mxinfo" id="T4:U186"><span class="var type1" id="S4T2U219">qin</span>(<span class="mxinfo" id="T4:U188">1</span>)</span>.*<span class="mxinfo" id="T4:U189"><span class="var type1" id="S4T2U222">qin</span>(<span class="mxinfo" id="T4:U191">2</span>)</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="43,38" id="srcline38">38</a></span><span class="line"><span class="mxinfo" id="T4:U192"><span class="mxinfo" id="T4:U193"><span class="var type1" id="S2T14U227">dcm</span>(<span class="mxinfo" id="T4:U195">3</span>,<span class="mxinfo" id="T4:U196">3</span>)</span> = <span class="mxinfo" id="T4:U197"><span class="mxinfo" id="T4:U198"><span class="mxinfo" id="T4:U199"><span class="mxinfo" id="T4:U200"><span class="mxinfo" id="T4:U201"><span class="var type1" id="S4T2U235">qin</span>( <span class="mxinfo" id="T4:U203">1</span>)</span>.^2</span> - <span class="mxinfo" id="T4:U204"><span class="mxinfo" id="T4:U205"><span class="var type1" id="S4T2U240">qin</span>(<span class="mxinfo" id="T4:U207">2</span>)</span>.^2</span></span> - <span class="mxinfo" id="T4:U208"><span class="mxinfo" id="T4:U209"><span class="var type1" id="S4T2U245">qin</span>(<span class="mxinfo" id="T4:U211">3</span>)</span>.^2</span></span> + <span class="mxinfo" id="T4:U212"><span class="mxinfo" id="T4:U213"><span class="var type1" id="S4T2U250">qin</span>(<span class="mxinfo" id="T4:U215">4</span>)</span>.^2</span></span></span>;</span></span>
</pre>
